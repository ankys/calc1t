
\chapter{級数}

\section{級数の収束}

数列$(a_n)_{n = 0}^\infty$の項$a_0, a_1, a_2, a_3, \cdots$の和について考える。
このような和のことを級数と呼び、形式的には
$$
\sum_{n = 0}^\infty a_n = a_0+a_1+a_2+a_3+\cdots
$$
と表すが、無限個の項の和なのでしっかり定義する必要がある。

\begin{definition}[級数]
数列$(a_n)_n$と$N = 0, 1, 2, 3, \cdots$に対して、初項から項$a_N$までの\emph{部分和}
$$
S_N = \sum_{n = 0}^N a_n = a_0+a_1+a_2+a_3+\cdots+a_N
$$
を定義する。
ここで部分和を並べて得られる数列$(S_N)_N$がある数$S$に収束する時、
\emph{級数}$\sum_n a_n$は収束するといい、この時の極限$S$を数列$(a_n)_n$の級数の値または\emph{和}と呼び$\sum_n a_n$で表す。
また、部分和の数列$(S_N)_N$が発散するとき、級数$\sum_n a_n$は発散するという。
級数の表記は
$$
\sum_{n = 0}^\infty a_n, \quad \sum_{n = 1}^\infty a_n, \quad \sum_{n \in \mathbb{N}}a_n, \quad \sum_n a_n, \quad \sum a_n
$$
などがある。
\end{definition}

\begin{example}
$c$を実数として等比数列$(c^n)_{n = 0}^\infty$を考える。
対応する級数$\sum_{n = 0}^\infty c^n$を等比級数という。
$c \ne 1$の時、部分和は
$$
\sum_{n = 0}^N c^n = \frac{c^{N+1}-1}{c-1} = \frac{1-c^{N+1}}{1-c}
$$
であり、$-1 < c < 1$のとき収束し級数の値は
$$
\sum_{n = 0}^\infty c^n = \frac{1}{1-c}
$$
である。
それ以外の$c$の場合は発散する。
$c = 1$の場合も$\sum_{n = 0}^N c^n = N$より発散する。
\end{example}

次の命題は級数が収束する必要条件を与える。

\begin{proposition}
数列$(a_n)$に対して、級数$\sum a_n$が収束するならば数列$(a_n)$は$0$に収束する。
\end{proposition}

\begin{proof}
各$n$に対して、
$$
a_{n+1} = S_{n+1}-S_n
$$
が成り立つ。
級数$\sum a_n$が収束するため、$(S_n)$と$(S_{n+1})$はともに和$S$に収束することから、数列$(a_{n+1})$ひいては$(a_n)$は$S-S = 0$に収束する。
\end{proof}

\begin{remark}
この命題の逆は成立しない。
例えば$n = 1, 2, 3, \cdots$に対して$a_n = n^{-1}$とおくと、
$$
S_{2^2} = 1+\frac{1}{2}+\frac{1}{3}+\frac{1}{4} > 1+\frac{1}{2}+\frac{1}{4}+\frac{1}{4} = 1+\frac{1}{2}+\frac{1}{2},
$$
$$
S_{2^3} = 1+\frac{1}{2}+\frac{1}{3}+\frac{1}{4}+\frac{1}{5}+\frac{1}{6}+\frac{1}{7}+\frac{1}{8} > 1+\frac{1}{2}+\frac{1}{4}+\frac{1}{4}+\frac{1}{8}+\frac{1}{8}+\frac{1}{8}+\frac{1}{8} = 1+\frac{1}{2}+\frac{1}{2}+\frac{1}{2}
$$
で、
続けると
$$
S_{2^k} > 1+\frac{k}{2}
$$
がわかり、これは収束しない。
\end{remark}

級数（数列）の中でも特別なのが次の正項級数である。

\begin{definition}[正項級数]
数列$(a_n)$が各自然数$n$に対して$a_n \ge 0$を満たすとき、級数$\sum a_n$を\emph{正項級数}という。
\end{definition}

\begin{proposition}
正項級数$\sum a_n$が収束するための必要十分条件は部分和の数列$(S_N)$が上に有界であることである。
\end{proposition}

\begin{proof}
$\sum a_n$が正項級数であることから、各自然数$N$に対して
$$
S_{N+1}-S_N = a_{N+1} \ge 0
$$
より、数列$(S_N)$は単調増加である。
したがって$(S_N)$が上に有界ならば、単調収束定理（定理\ref{t_mono_conv}）より、収束する。
逆は命題\ref{t_conv_bdd}より従う。
\end{proof}

このため正項級数の場合に限って級数$\sum a_n$が収束することを
$$
\sum a_n < \infty
$$
と表し、発散することを
$$
\sum a_n = \infty
$$
と表す。

\begin{definition}[級数の絶対収束と条件収束]
級数$\sum a_n$に対して正項級数$\sum |a_n|$が収束するとき、級数$\sum a_n$は\emph{絶対収束}するという。
絶対収束しないが収束するとき、級数は\emph{条件収束}するという。
\end{definition}

\begin{remark}
級数が絶対収束するならばそれは収束している。
\end{remark}

ここまでくると級数の理論は広義積分の理論と似ていることに気が付く。
つまり、級数の収束は部分和の極限で定義していることは広義積分の積分区間を有界閉区間で近似していたことに対応するし、
級数でも広義積分でも絶対収束が登場する。
実際次の命題は級数版の比較判定法である。

\begin{proposition}[級数の比較判定法]
$(a_n)$を数列とする。
\begin{itemize}
\item
二つの条件
$$
|a_n| \le b_n \quad \forall n,
\quad \sum b_n < \infty
$$
を満たす正項級数$\sum b_n$が存在するならば、
級数$\sum a_n$は絶対収束し、
$$
\abs{\sum a_n} \le \sum \abs{a_n} \le \sum b_n
$$
が成り立つ。
\item
二つの条件
$$
|a_n| \ge b_n \quad \forall n,
\quad \sum b_n = \infty
$$
を満たす正項級数$\sum b_n$が存在するならば、
級数$\sum a_n$は絶対収束せず、
$$
\sum \abs{a_n} = \infty
$$
である。
\end{itemize}
\end{proposition}

級数を等比級数と比較することで収束性をある程度判定することができる。

\begin{theorem}[ダランベールの判定法]
$(a_n)$をどの項も$0$でない数列とする。
極限
$$
\lim_{n \to \infty}\abs{\frac{a_{n+1}}{a_n}} = c
$$
が存在し、$c < 1$ならば級数$\sum a_n$は絶対収束し、$c > 1$ならば級数$\sum a_n$は発散する。
\end{theorem}

\begin{theorem}[コーシーの判定法]
$(a_n)$を数列とする。
上極限
$$
\limsup_{n \to \infty}\sqrt[n]{\abs{a_n}} = c
$$
について、$c < 1$ならば級数$\sum a_n$は絶対収束し、$c > 1$ならば級数$\sum a_n$は発散する。
\end{theorem}

\begin{remark}
どちらの判定法も$c = 1$の場合は級数が収束するか発散するかわからない。
\end{remark}

\begin{example}
級数
$$
\sum_{n = 0}^\infty n\frac{1}{2^n}
$$
は（絶対）収束する。
実際、$a_n = n\frac{1}{2^n}$とおくと、$n \to \infty$で
$$
\abs{\frac{a_{n+1}}{a_n}} = \frac{n+1}{n}\frac{2^n}{2^{n+1}} = \frac{n+1}{n}\frac{1}{2} \to \frac{1}{2} < 1
$$
より、ダランベールの判定法が使える。
\end{example}

\begin{example}
級数
$$
\sum_{n = 0}^\infty \frac{1}{n^2}
$$
ではこれらの判定法はともに$c = 1$となってしまい、級数が収束するか発散するか判定できない。
\end{example}

このような級数に対しては次の定理で広義積分の判定に帰着させるとよい。

\begin{theorem}[級数と広義積分の比較]
$f$を$[0, +\infty)$上定義された単調減少する非負値の関数とする。
このとき級数
$$
\sum_{n = 0}^\infty f(n)
$$
が（絶対）収束することと広義積分
$$
\int_0^\infty f(x)\dd{x}
$$
が（絶対）収束することは同値である。
\end{theorem}

\begin{proof}
$[0, +\infty)$上の関数$\overline{g}(x)$と$\underline{g}(x)$を
$$
\overline{g}(x) = f(\lrfloor{x}),
\quad \underline{g}(x) = f(\lrceil{x})
$$
で定義すると、$f$は単調減少することから$\overline{g}(x)$と$\underline{g}(x)$は
$$
\underline{g}(x) \le f(x) \le \overline{g}(x)
$$
を満たす単調減少関数である。
またここで、
$$
\sum_{n = 0}^\infty f(n) = \int_0^\infty \overline{g}(x)\dd{x}
$$
もわかるので、
$$
\sum_{n = 1}^\infty f(n) \le \int_0^\infty f(x)\dd{x} \le \sum_{n = 0}^\infty f(n)
$$
が従い、級数と広義積分の比較判定ができる。
\end{proof}

例えば次のことがわかる。

\begin{proposition}
$a$を実数とするとき、
$$
\sum_{n = 0}^\infty n^a
\begin{cases}
= \infty & (a \ge -1), \\
< \infty & (a < -1).
\end{cases}
$$
\end{proposition}

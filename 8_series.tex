
\chapter{級数}

\section{級数の収束}

数列$(a_n)_{n = 0}^\infty$の項$a_0, a_1, a_2, a_3, \cdots$の和について考える。
このような和のことを級数と呼び、形式的には
$$
\sum_{n = 0}^\infty a_n = a_0+a_1+a_2+a_3+\cdots
$$
と表すが、無限個の項の和なのでしっかり定義する必要がある。

\begin{definition}[級数]
数列$(a_n)_n$と$N = 0, 1, 2, 3, \cdots$に対して、初項から項$a_N$までの\emph{部分和}
$$
A_N = \sum_{n = 0}^N a_n = a_0+a_1+a_2+a_3+\cdots+a_N
$$
を定義する。
ここで部分和を並べて得られる数列$(A_N)_N$がある数$S$に収束する時、
\emph{級数}$\sum_n a_n$は収束するといい、この時の極限$S$を数列$(a_n)_n$の級数の値または\emph{和}と呼び$\sum_n a_n$で表す。
また、部分和の数列$(A_N)_N$が発散するとき、級数$\sum_n a_n$は発散するという。
級数の表記は
$$
\sum_{n = 0}^\infty a_n, \quad \sum_{n = 1}^\infty a_n, \quad \sum_{n \in \mathbb{N}}a_n, \quad \sum_n a_n, \quad \sum a_n
$$
などがある。
\end{definition}

\begin{example}
$c$を実数として等比数列$(c^n)_{n = 0}^\infty$を考える。
対応する級数
$$
\sum_{n = 0}^\infty c^n = 1+c+c^2+c^3+\cdots
$$
を等比級数という。
$c \ne 1$の時、部分和は
$$
\sum_{n = 0}^N c^n = \frac{c^{N+1}-1}{c-1} = \frac{1-c^{N+1}}{1-c}
$$
であり、$-1 < c < 1$のとき収束し級数の値は
$$
\sum_{n = 0}^\infty c^n = \frac{1}{1-c}
$$
である。
それ以外の$c$の場合は発散する。
$c = 1$の場合も$\sum_{n = 0}^N c^n = N$より発散する。
\end{example}

次の命題は級数が収束する必要条件を与える。

\begin{proposition}
\label{t_ser_conv}
数列$(a_n)$に対して、級数$\sum a_n$が収束するならば数列$(a_n)$は$0$に収束する。
\end{proposition}

\begin{proof}
各$n$に対して、
$$
a_{n+1} = A_{n+1}-A_n
$$
が成り立つ。
級数$\sum a_n$が収束するため、$(A_n)$と$(A_{n+1})$はともに和$S$に収束することから、数列$(a_{n+1})$ひいては$(a_n)$は$S-S = 0$に収束する。
\end{proof}

\begin{remark}
\label{t_harm_ser}
この命題の逆は成立しない。
例えば$n = 1, 2, 3, \cdots$に対して$a_n = \frac{1}{n}$とおいた級数
$$
\sum_{n = 1}^\infty \frac{1}{n} = \frac{1}{1}+\frac{1}{2}+\frac{1}{3}+\cdots
$$
は収束しない。
実際、
$$
A_{2^2} = 1+\frac{1}{2}+\frac{1}{3}+\frac{1}{4} > 1+\frac{1}{2}+\frac{1}{4}+\frac{1}{4} = 1+\frac{1}{2}+\frac{1}{2},
$$
$$
A_{2^3} = 1+\frac{1}{2}+\frac{1}{3}+\frac{1}{4}+\frac{1}{5}+\frac{1}{6}+\frac{1}{7}+\frac{1}{8} > 1+\frac{1}{2}+\frac{1}{4}+\frac{1}{4}+\frac{1}{8}+\frac{1}{8}+\frac{1}{8}+\frac{1}{8} = 1+\frac{1}{2}+\frac{1}{2}+\frac{1}{2}
$$
で、
続けると
$$
A_{2^k} > 1+\frac{k}{2}
$$
がわかり、これは収束しない。
\end{remark}

級数（数列）の中でも特別なのが次の正項級数である。

\begin{definition}[正項級数]
数列$(a_n)$が各自然数$n$に対して$a_n \ge 0$を満たすとき、級数$\sum a_n$を\emph{正項級数}という。
\end{definition}

\begin{proposition}
正項級数$\sum a_n$が収束するための必要十分条件は部分和の数列$(A_N)$が上に有界であることである。
\end{proposition}

\begin{proof}
$\sum a_n$が正項級数であることから、各自然数$N$に対して
$$
A_{N+1}-A_N = a_{N+1} \ge 0
$$
より、数列$(A_N)$は単調増加である。
したがって$(A_N)$が上に有界ならば、単調収束定理（定理\ref{t_mono_conv}）より、収束する。
逆は命題\ref{t_conv_bdd}より従う。
\end{proof}

このため正項級数の場合に限って級数$\sum a_n$が収束することを
$$
\sum a_n < \infty
$$
と表し、発散することを
$$
\sum a_n = \infty
$$
と表す。

\begin{definition}[級数の絶対収束と条件収束]
級数$\sum a_n$に対して正項級数$\sum |a_n|$が収束するとき、級数$\sum a_n$は\emph{絶対収束}するという。
絶対収束しないが収束するとき、級数は\emph{条件収束}するという。
\end{definition}

\begin{remark}
級数が絶対収束するならばそれは収束している。
\end{remark}

ここまでくると級数の理論は広義積分の理論と似ていることに気が付く。
つまり、級数の収束は部分和の極限で定義していることは広義積分の積分区間を有界閉区間で近似していたことに対応するし、
級数でも広義積分でも絶対収束が登場する。
実際次の命題は級数版の比較判定法である。

\begin{proposition}[級数の比較判定法]
$(a_n)$を数列とする。
\begin{itemize}
\item
二つの条件
$$
|a_n| \le b_n \quad \forall n,
\quad \sum b_n < \infty
$$
を満たす正項級数$\sum b_n$が存在するならば、
級数$\sum a_n$は絶対収束し、
$$
\abs{\sum a_n} \le \sum \abs{a_n} \le \sum b_n
$$
が成り立つ。
\item
二つの条件
$$
|a_n| \ge b_n \quad \forall n,
\quad \sum b_n = \infty
$$
を満たす正項級数$\sum b_n$が存在するならば、
級数$\sum a_n$は絶対収束せず、
$$
\sum \abs{a_n} = \infty
$$
である。
\end{itemize}
\end{proposition}

級数を等比級数と比較することで収束性をある程度判定することができる。

\begin{theorem}[ダランベールの判定法]
$(a_n)$をどの項も$0$でない数列とする。
極限
$$
\lim_{n \to \infty}\abs{\frac{a_{n+1}}{a_n}} = c
$$
が存在し、$c < 1$ならば級数$\sum a_n$は絶対収束し、$c > 1$ならば級数$\sum a_n$は発散する。
\end{theorem}

\begin{theorem}[コーシーの判定法]
$(a_n)$を数列とする。
上極限
$$
\limsup_{n \to \infty}\sqrt[n]{\abs{a_n}} = c
$$
について、$c < 1$ならば級数$\sum a_n$は絶対収束し、$c > 1$ならば級数$\sum a_n$は発散する。
\end{theorem}

\begin{remark}
どちらの判定法も$c = 1$の場合は級数が収束するか発散するかわからない。
\end{remark}

\begin{example}
級数
$$
\sum_{n = 0}^\infty \frac{n}{2^n} = \frac{0}{1}+\frac{1}{2}+\frac{2}{2^2}+\frac{3}{2^3}+\cdots
$$
は（絶対）収束する。
実際、$a_n = \frac{n}{2^n}$とおくと、$n \to \infty$で
$$
\abs{\frac{a_{n+1}}{a_n}} = \frac{n+1}{n}\frac{2^n}{2^{n+1}} = \frac{n+1}{n}\frac{1}{2} \to \frac{1}{2} < 1
$$
より、ダランベールの判定法が使えて、収束する。
\end{example}

\begin{example}
級数
$$
\sum_{n = 1}^\infty \frac{1}{n^2} = \frac{1}{1^2}+\frac{1}{2^2}+\frac{1}{3^2}+\cdots
$$
ではダランベールの判定法とコーシーの判定法はともに$c = 1$となってしまい、級数が収束するか発散するか判定できない。
なお、実際にはすぐ次でわかる通り収束する。
\end{example}

このような級数に対しては次の定理で広義積分の判定に帰着させるとよい。

\begin{theorem}[級数と広義積分の比較]
$f$を$[0, +\infty)$上定義された単調減少する非負値の関数とする。
このとき級数
$$
\sum_{n = 0}^\infty f(n)
$$
が（絶対）収束することと広義積分
$$
\int_0^\infty f(x)\dd{x}
$$
が（絶対）収束することは同値である。
\end{theorem}

\begin{proof}
$[0, +\infty)$上の関数$\overline{g}(x)$と$\underline{g}(x)$を
$$
\overline{g}(x) = f(\lrfloor{x}),
\quad \underline{g}(x) = f(\lrceil{x})
$$
で定義すると、$f$は単調減少することから$\overline{g}(x)$と$\underline{g}(x)$は
$$
\underline{g}(x) \le f(x) \le \overline{g}(x)
$$
を満たす単調減少関数である。
またここで、
$$
\sum_{n = 0}^\infty f(n) = \int_0^\infty \overline{g}(x)\dd{x}
$$
もわかるので、
$$
\sum_{n = 1}^\infty f(n) \le \int_0^\infty f(x)\dd{x} \le \sum_{n = 0}^\infty f(n)
$$
が従い、級数と広義積分の比較判定ができる。
\end{proof}

例えば次のことがわかる。

\begin{proposition}
$a$を実数とするとき、
$$
\sum_{n = 0}^\infty n^a
\begin{cases}
= \infty & (a \ge -1), \\
< \infty & (a < -1).
\end{cases}
$$
\end{proposition}

\section{交代級数と条件収束}

各項の符号が常に正（正確には非負）なのが正項級数であったが、項の符号が順番に入れ替わっていく級数を考える。

\begin{definition}[交代級数]
数列$(a_n)$が各自然数$n$に対して
$$
a_n a_{n+1} \le 0
$$
を満たすとき、級数$\sum a_n$を\emph{交代級数}という。
\end{definition}

絶対収束しない場合でも交代級数であれば収束することがある。
次の定理はある種の交代級数の収束性を保証する。

\begin{theorem}[ライプニッツの判定法]
数列$(a_n)_{n = 0}^\infty$が単調減少し$n \to \infty$で$0$に収束するとする。
このとき、交代級数$\sum_{n = 0}^\infty (-1)^n a_n$は収束し、各$N = 0, 1, 2, 3, \cdots$に対して
$$
\abs{\sum_{n = 0}^N (-1)^n a_n-\sum_{n = 0}^\infty (-1)^n a_n} \le a_{N+1}
$$
を満たす。
\end{theorem}

\begin{proof}
$N = 0, 1, 2, 3, \cdots$に対して部分和を$A_N = \sum_{n = 0}^N (-1)^n a_n$とおく。
このとき、$K = 0, 1, 2, 3, \cdots$に対して
$$
A_{2(K+1)} = A_{2 K}-a_{2 K+1}+a_{2 K+2} \le A_{2 K},
$$
$$
A_{2(K+1)+1} = A_{2 K+1}+a_{2 K+2}-a_{2 K+3} \le A_{2 K+1}
$$
より
$$
A_1 \le A_3 \le A_5 \le A_7 \le \cdots \le A_6 \le A_4 \le A_2 \le A_0
$$
がわかる。
したがって単調収束定理より$(A_{2 K})_K$と$(A_{2 K+1})_K$は収束し極限をそれぞれ$\overline{L}$と$\underline{L}$とおくと$\underline{L} \le \overline{L}$である。
また、ここで
$$
A_{2 K}-A{2 K+1} = a_{2 K} \to 0
$$
より$\overline{L}-\underline{L} \le 0$つまり$\overline{L} = \underline{L} = L$である。
あとは$|A_N-L| \le a_{N+1}$を示す。
\begin{itemize}
\item
$N = 2 K$の場合、
$$
|A_N-L| = A_{2 K}-L \le A_{2 K}-A_{2 K+1} = a_{2 K+1} = a_{N+1}.
$$
\item
$N = 2 K+1$の場合、
$$
|A_N-L| = L-A_{2 K+1} \le A_{2 K+2}-A_{2 K+1} = a_{2 K+2} = a_{N+1}.
$$
\end{itemize}
以上より示すべき不等式が示されて、直ちに$A_N \to L$つまり交代級数が収束することが示される。
\end{proof}

\begin{example}
\label{t_alt_harm_ser}
交代級数
$$
\sum_{n = 1}^\infty \frac{(-1)^{n-1}}{n} = \frac{1}{1}-\frac{1}{2}+\frac{1}{3}-\cdots
$$
は対応する正項級数$\sum_{n = 1}^\infty \frac{1}{n}$が収束しないので絶対収束しない（注意\ref{t_harm_ser}参照）。
一方で$a_n = \frac{1}{n}$はライプニッツの判定法の仮定を満たすので、収束することがわかる。
つまり、条件収束する。
\end{example}

交代級数に対するこの収束の判定法を一般化して次の収束の条件が知られている。

\begin{theorem}[ディリクレの判定法]
実数列$(a_n)_{n = 0}^\infty$は単調減少し$n \to \infty$で$0$に収束するとする。
数列$(b_n)_{n = 0}^\infty$は部分和の数列$(B_N)$が有界、つまりある実数$M$が存在し任意の$N = 0, 1, 2, 3, \cdots$に対して$\abs{\sum_{n = 0}^N b_n} \le M$が成り立つとする。
このとき級数$\sum_{n = 0}^\infty a_n b_n$は収束する。
\end{theorem}

\begin{proof}
まず、部分和を$S_N = \sum_{n = 0}^N a_n b_n$とおく。
ここで、部分和分（命題\ref{t_sum_part}）より$B_{-1} = 0$と考えることで、
$$
S_N = \sum_{n = 0}^N a_n(B_n-B_{n-1}) = a_{N+1}B_N+\sum_{n = 0}^\infty (a_n-a_{n+1})B_n
$$
ここで$(B_N)$が有界で$a_N \to 0$より$a_{N+1}B_N \to 0$である。
また、仮定$a_{n+1} \le a_n$を使うと、
$$
\abs{(a_n-a_{n+1})B_n} \le (a_n-a_{n+1})\abs{B_n} \le (a_n-a_{n+1})M
$$
で
$$
\sum_{n = 0}^N (a_n-a_{n+1})M = (a_0-a_{N+1})M \le a_0 M < \infty
$$
なので比較判定法から$\sum_{n = 0}^\infty (a_n-a_{n+1})B_n$も収束し、$(S_N)$の収束も示された。
\end{proof}

\begin{example}
交代級数の例\ref{t_alt_harm_ser}の類似として級数
$$
\sum_{n = 1}^\infty \frac{\sin\frac{2\pi}{3}n}{n} = \frac{\frac{\sqrt{3}}{2}}{1}-\frac{\frac{\sqrt{3}}{2}}{2}+\frac{0}{3}+\cdots
$$
を考える。
$a_n = \frac{1}{n}$, $b_n = \sin\frac{2\pi}{3}n$とするとディリクレの判定法の仮定を満たすので、条件収束することがわかる。
一般に和$\sum_{n = M}^N \sin n\theta$は計算できる（後の章を参照）ことから、級数
$$
\sum_{n = 1}^\infty \frac{\sin n}{n} = \frac{\sin 1}{1}+\frac{\sin 2}{2}+\frac{\sin 3}{3}+\cdots
$$
などはやはり条件収束することがわかる。
\end{example}

\section{べき級数}

\begin{definition}[べき級数]
数列$(a_n)_{n = 0}^\infty$と数$a$と$x$に対して定まる次の形の級数
$$
\sum_{n = 0}^\infty a_n(x-a)^n = a_0+a_1(x-a)+a_2(x-a)^2+a_3(x-a)^3+\cdots
$$
を\emph{べき級数}または\emph{整級数}という。
\end{definition}

べき級数は単一の$x$のみ考えるなら特殊な形の級数であるが、重要な点は$x$を変数、べき級数を関数と見て議論を展開する点にある。
以降では簡単のため$a = 0$の場合のみ考える。

\begin{remark}
べき級数$\sum_{n = 0}^\infty a_n x^n$は$x = 0$のとき$a_0$に必ず収束する。
\end{remark}

\begin{proposition}[べき級数の収束性]
べき級数$\sum_{n = 0}^\infty a_n x^n$が点$x = b \ne 0$で収束するならば、$|x| < |b|$を満たすすべての点$x$でこのべき級数は絶対収束する。
\end{proposition}

\begin{proof}
級数$\sum_{n = 0}^\infty a_n b^n$が収束するので、命題\ref{t_ser_conv}より数列$(a_n b^n)_{n = 0}^\infty$は$0$に収束し、特に有界である。
そこである実数$M$が存在し、任意の$n = 0, 1, 2, 3, \cdots$に対して$|a_n b^n| \le M$である。
ここで
$$
|a_n x^n| = |a_n b^n|\abs{\frac{x}{b}}^n \le M\abs{\frac{x}{b}}^n
$$
であり、$|x| < |b|$であることから右辺から定まる正項級数は収束するので、
級数$\sum_{n = 0}^\infty a_n x^n$は絶対収束する。
\end{proof}

この命題をもとに各べき級数には固有な次の値が定義できる。

\begin{definition}[収束半径]
べき級数$\sum_{n = 0}^\infty a_n x^n$に対して
$$
\sup\lrset{|b| \mid \text{級数$\sum_{n = 0}^\infty a_n b^n$が収束する}}
$$
は非負の実数または正の無限大で、べき級数$\sum_{n = 0}^\infty a_n x^n$の\emph{収束半径}という。
\end{definition}

\begin{remark}
$r$を収束半径とするとき、$|x| > r$に対してはべき級数は必ず発散し、$|x| < r$に対しては先の命題よりべき級数は必ず絶対収束する。
$r = \infty$の場合では任意の$x$でべき級数は絶対収束する。
\end{remark}

\begin{remark}
収束半径という用語に「半径」という単語が入っているのはべき級数の理論を$a_n$や$x$が複素数に拡張したときに絶対収束が言える$x$の範囲$|x| < r$が複素平面での円板になっていることによる。
実際、この章の内容は複素数の範囲に拡張でき、後の複素指数関数の部分で使われる。
\end{remark}

級数の収束に関するダランベールの判定法やコーシーの判定法から収束半径について次の公式が知られている。

\begin{theorem}[ダランベールの判定法]
\end{theorem}

\begin{theorem}[コーシーの判定法]
べき級数$\sum_{n = 0}^\infty a_n x^n$を考える。
\begin{itemize}
\item
さらに$(a_n)$はどの項も$0$でない数列として、極限
$$
\lim_{n \to \infty}\abs{\frac{a_{n+1}}{a_n}} = c
$$
が存在したとするとき、べき級数の収束半径は逆数$c^{-1}$となる。
\item
上極限
$$
\limsup_{n \to \infty}\sqrt[n]{\abs{a_n}} = c
$$
について、べき級数の収束半径は逆数$c^{-1}$となる。
\end{itemize}
\end{theorem}

\begin{example}
数$c$に対してべき級数
$$
\sum_{n = 0}^\infty c^n x^n = 1+c x+c^2 x^2+c^3 x^3+\cdots
$$
を考える。
$\lim_{n \to \infty}\abs{\frac{c^{n+1}}{c^n}} = |c|$よりこのべき級数の収束半径は$|c|^{-1}$である。
\end{example}

\begin{example}
数$c$に対してべき級数
$$
\sum_{n = 0}^\infty c^n x^{2 n} = 1+c x^2+c^2 x^4+c^3 x^6+\cdots
$$
を考える。
$\lim_{n \to \infty}\sqrt[2 n]{\abs{c^n}} = \sqrt{|c|}$よりこのべき級数の収束半径は$\sqrt{|c|}^{-1}$である。
\end{example}
